---
import Main from "../layouts/main.astro";
// import CollegeSelect from '../components/get_started/college_selection/collegeSelect.svelte'
import CollegeSelect from "../components/get_started/1_college_selection/collegeSelect.astro";
import CourseSelect from "../components/get_started/2_course_selection/courseSelect.astro";
import colleges from "../data/collegelist.json";
---

<Main title="Get Started">
    <div
        class="dark:text-white dark:bg-[#181818] flex flex-col min-h-screen h-screen max-h-max"
    >
        <!-- Header -->
        <div class="w-full flex justify-center items-center pt-12">
            <div class="w-11/12 2xl:w-4/6 flex items-center gap-4">
                <svg
                    class="w-5 dark:fill-white fill-black"
                    width="1.25rem"
                    height="1.25rem"
                    xmlns="http://www.w3.org/2000/svg"
                    data-v-91817bbc=""
                    width="16"
                    height="16"
                    viewBox="0 0 16 16"
                    ><path
                        data-v-91817bbc=""
                        clip-rule="evenodd"
                        d="M3 7.95711L10.9571 15.9142L12.3713 14.5L5.82843 7.95711L12.3713 1.41421L10.9571 0L3 7.95711Z"
                    ></path></svg
                >
                <!-- progrress-bar -->
                <div
                    class="bg-gray-200 dark:bg-neutral-700 w-full h-1 flex rounded-lg"
                    id="progress-container"
                >
                    <!-- progrress-bar-completed -->
                    <span
                        class="transition-all duration-700 bg-green-600 dark:bg-green-500"
                        id="progress-completed"
                        style="width:0px"></span>
                </div>

                <svg
                    class="w-5 dark:fill-white fill-black rotate-180"
                    width="1.25rem"
                    height="1.25rem"
                    xmlns="http://www.w3.org/2000/svg"
                    data-v-91817bbc=""
                    width="16"
                    height="16"
                    viewBox="0 0 16 16"
                    ><path
                        data-v-91817bbc=""
                        clip-rule="evenodd"
                        d="M3 7.95711L10.9571 15.9142L12.3713 14.5L5.82843 7.95711L12.3713 1.41421L10.9571 0L3 7.95711Z"
                    ></path></svg
                >
            </div>
        </div>
        <div class="h-full max-h-max overflow-x-hidden relative">
            <button
                class="opacity-0 transition-opacity dark:border dark:border-[#295157] absolute bg-gradient-to-tr from-[#355c6342] from-18% to-[#27b0eba8] py-2 px-5 rounded-md text-lg z-50 top-32 right-64 "
                id="next_button"
                >Next
            </button>
            <!-- Mover Element -->
            <div
                class="flex h-full relative transition-all ease-[cubic-bezier(.03,0,.01,1)] duration-1000 left-0"
                id="mover-element"
            >
                <CollegeSelect colleges={colleges} />
                <CourseSelect />
            </div>
        </div>
    </div>
</Main>

<script>
    let progBar: HTMLSpanElement | null = document.querySelector(
        "#progress-completed"
    );
    let progCon: HTMLDivElement | null = document.querySelector(
        "#progress-container"
    );
    let moverElem: HTMLDivElement | null =
        document.querySelector("#mover-element");
    let nextButton: HTMLDivElement | null =
        document.querySelector("#next_button");

    // Code to do something on Next button click
    if (moverElem && progCon && progBar) {
        moverElem.style.width = moverElem.children.length * 100 + "%";
        moverElem.addEventListener("click", (e: Event) => {
            let target = e.target as HTMLElement
            if (target && nextButton && target.ariaLabel == "trig_button") {
                nextButton.style.opacity = "1";
            }
        });
    }
    nextButton?.addEventListener("mousedown", (event) => {
        event.preventDefault();
        if (!nextButton || !moverElem || !progBar ||!progCon) return;
        nextButton.style.opacity = "0";
        moverElem.style.left = parseInt(moverElem.style.left?moverElem.style.left:'0' ) - 100 + "%";
        setTimeout(() => {
           if (!nextButton || !moverElem || !progBar ||!progCon) return;
            progBar.style.width = progBar.offsetWidth + (progCon.offsetWidth)/moverElem.children.length + 'px' 
        }, 100);
    });
</script>
